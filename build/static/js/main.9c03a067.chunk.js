(this["webpackJsonpform-sender"]=this["webpackJsonpform-sender"]||[]).push([[0],{28:function(e,a,t){e.exports=t.p+"static/media/file-item.b202d438.svg"},29:function(e,a,t){e.exports=t.p+"static/media/trash.f81c7834.svg"},30:function(e,a,t){e.exports=t.p+"static/media/file.6a4388d1.svg"},34:function(e,a,t){e.exports=t(55)},45:function(e,a,t){},46:function(e,a,t){},47:function(e,a,t){},48:function(e,a,t){},49:function(e,a,t){},50:function(e,a,t){},51:function(e,a,t){},52:function(e,a,t){},53:function(e,a,t){},54:function(e,a,t){},55:function(e,a,t){"use strict";t.r(a);var n=t(0),r=t.n(n),s=t(15),c=t.n(s),l=t(13),i=t(8),o=t(33),u=t(6),m=t(7),d="REQUEST_MESSAGES",f="REQUEST_SUCCESS_MESSAGES",g="REQUEST_FAIL_MESSAGES",p="UPDATE_MESSAGE_TRACK",v="UPDATE_MESSAGE_SUCCES_TRACK",E=function(e){var a=[],t=localStorage.getItem("messages");t&&(a=JSON.parse(t)),a.push(e),localStorage.setItem("messages",JSON.stringify(a))},b=function(e){var a=localStorage.getItem("messages");if(a){var t=JSON.parse(a),n=t.findIndex((function(a){return a.trackId===e.trackId}));t.splice(n,1,e),localStorage.setItem("messages",JSON.stringify(Object(u.a)(t)))}},h=function(){var e=localStorage.getItem("messages");return e?JSON.parse(e):null}(),O={data:h&&h.length?h:[],loading:!1,currentMessage:{}},j=Object(i.c)({messages:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O,a=arguments.length>1?arguments[1]:void 0,t=a.type,n=a.payload;switch(t){case d:return Object(m.a)({},e,{currentMessage:n.message,loading:n.loading});case f:return Object(m.a)({},e,{data:[].concat(Object(u.a)(e.data),[n.message]),loading:n.loading});case g:return Object(m.a)({},e,{loading:n.loading});case v:var r=n.message,s=e.data.findIndex((function(e){return e.trackId===r.trackId}));return e.data.splice(s,1,r),Object(m.a)({},e,{data:Object(u.a)(e.data)});default:return e}}}),N=t(9),_=t.n(N),x=t(12);function S(e){return{type:f,payload:{message:e,loading:!1}}}var y=t(24),C=t(25),w=t(26),k=t.n(w),M=(new(function(){function e(){Object(y.a)(this,e)}return Object(C.a)(e,[{key:"create",value:function(){return this.sendsay?this.sendsay:this.sendsay=new k.a({auth:{login:"paramount7891@gmail.com",password:"umu8Vaeya"}})}}]),e}())).create(),I={getMessageTrack:function(e){var a=e.subject,t=e.fromName,n=e.fromEmail,r=e.toName,s=e.toEmail,c=e.messages,l=e.attaches;return M.request({action:"issue.send.test",letter:{subject:a.value,"from.name":t.value,"from.email":n.value,"to.name":r.value,message:{text:c.value},attaches:l.map((function(e){return{name:e.name,content:e.content,encoding:e.encoding}}))},sendwhen:"test",mca:[s.value]}).then((function(e){return e["track.id"]}))},getMessageStatus:function(e){return M.request({action:"track.get",id:e,session:"session"}).then((function(e){return e.obj.status}))}},A=["\u044f\u043d\u0432\u0430\u0440\u044f","\u0444\u0435\u0432\u0440\u0430\u043b\u044f","\u043c\u0430\u0440\u0442\u0430","\u0430\u043f\u0440\u0435\u043b\u044f","\u043c\u0430\u044f","\u0438\u044e\u043d\u044f","\u0438\u044e\u043b\u044f","\u0430\u0432\u0433\u0443\u0441\u0442\u0430","\u0441\u0435\u043d\u0442\u044f\u0431\u0440\u044f","\u043e\u043a\u0442\u044f\u0431\u0440\u044f","\u043d\u043e\u044f\u0431\u0440\u044f","\u0434\u0435\u043a\u0430\u0431\u0440\u044f"],T=function(){var e=new Date,a=e.getUTCMonth(),t=e.getUTCDate();return"".concat(t," ").concat(A[a])},R=_.a.mark(D),z=_.a.mark(F),U=_.a.mark(H);function D(e){var a,t,n;return _.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,a=e.payload.message,r.next=4,Object(x.a)(I.getMessageTrack,a);case 4:return t=r.sent,n={date:T(),title:a.subject.value,status:1,trackId:t},E(n),r.next=9,Object(x.a)(I.getMessageStatus,t);case 9:return n.status=r.sent,r.next=12,Object(x.b)(S(n));case 12:r.next=18;break;case 14:return r.prev=14,r.t0=r.catch(0),r.next=18,Object(x.b)((r.t0.message,{type:g,payload:{loading:!1}}));case 18:case"end":return r.stop()}}),R,null,[[0,14]])}function F(e){var a,t,n,r,s,c,l;return _.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:a=e.payload.messages,t=0;case 2:if(!(t<a.length)){i.next=16;break}if(n=a[t],r=n.status,s=n.trackId,!(r>-1)){i.next=13;break}return i.next=7,Object(x.a)(I.getMessageStatus,s);case 7:if(c=i.sent,+r===+c){i.next=13;break}return l=Object(m.a)({},a[t],{status:+c}),b(l),i.next=13,Object(x.b)({type:v,payload:{message:l}});case 13:t++,i.next=2;break;case 16:case"end":return i.stop()}}),z)}function H(){return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(x.c)(d,D);case 2:return e.next=4,Object(x.c)(p,F);case 4:case"end":return e.stop()}}),U)}var L=H,J=t(17),P=t(18),G=t(27),q=function(e,a){return"text"===a?e.length?null:"\u041f\u043e\u043b\u0435 \u043d\u0435 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u043f\u0443\u0441\u0442\u044b\u043c":"email"===a?e.length?/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(e).toLowerCase())?null:"\u041f\u043e\u043b\u0435 \u0437\u0430\u043f\u043e\u043b\u043d\u0435\u043d\u043e \u043d\u0435 \u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u043e":"\u041f\u043e\u043b\u0435 \u043d\u0435 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u043f\u0443\u0441\u0442\u044b\u043c":void 0};var Q=t(14),K=(t(45),function(e){var a=e.className,t=e.onChange,n=e.name,s=Object(Q.a)(e,["className","onChange","name"]);return r.a.createElement("div",{className:"input-wrap"},r.a.createElement("input",Object.assign({className:"input ".concat(a),onChange:function(e){var a=e.target.value,r=q(a,s.type);t({name:n,value:a,error:r})}},s)),s.error&&r.a.createElement("p",{className:"input__error"},s.error))}),V=(t(46),function(e){var a=e.onChange,t=e.name,n=Object(Q.a)(e,["onChange","name"]);return r.a.createElement("div",{className:"input-wrap"},r.a.createElement("textarea",Object.assign({className:"textarea",onChange:function(e){var r=e.target.value,s=q(r,n.type);a({name:t,value:r,error:s})}},n)),n.error&&r.a.createElement("p",{className:"input__error"},n.error))}),X=t(28),Z=t.n(X),B=t(29),$=t.n(B),W=(t(47),function(e){var a=e.file,t=e.idx,n=e.onRemove;return r.a.createElement("div",{className:"file-item"},r.a.createElement("img",{className:"file-item__ico",src:Z.a,alt:""}),r.a.createElement("span",{className:"file-item__name"},a.name),r.a.createElement("button",{type:"button",onClick:function(){return n(t)},className:"file-item__btn"},r.a.createElement("img",{src:$.a,alt:""}),"\u0423\u0434\u0430\u043b\u0438\u0442\u044c"))}),Y=(t(48),t(30)),ee=t.n(Y),ae=function(e){var a=e.changeHandler,t=e.attaches,s=e.removeFileHandler,c=Object(n.useRef)(null);return r.a.createElement("div",{className:"file-input"},!!t.length&&r.a.createElement("div",{className:"file-input__files"},t.map((function(e,a){return r.a.createElement(W,{onRemove:s,key:a,idx:a,file:e})}))),r.a.createElement("img",{src:ee.a,alt:""}),r.a.createElement("label",{htmlFor:"file",className:"file-input__label"},"\u041f\u0440\u0438\u043a\u0440\u0435\u043f\u0438\u0442\u044c \u0444\u0430\u0439\u043b"),r.a.createElement("input",{ref:c,type:"file",accept:"image/*, .doc, .xls, .pdf, .zip",id:"file",name:"file",multiple:!0,onChange:function(){a(Object(u.a)(c.current.files))}}))},te=(t(49),function(e){var a=e.disabled,t=e.children;return r.a.createElement("button",{className:"btn",disabled:a},t)}),ne=(t(50),function(e){var a=e.children;return r.a.createElement("div",{className:"modal"},r.a.createElement("div",{className:"modal__inner"},a))}),re=(t(51),function(e){var a=e.fields,t=e.formError,n=e.handlerInputChange,s=e.handlerAttachesChange,c=e.handlerRemoveFile,l=e.submitHandler,i=Object(Q.a)(e,["fields","formError","handlerInputChange","handlerAttachesChange","handlerRemoveFile","submitHandler"]);return r.a.createElement("form",{className:"form",onSubmit:l},r.a.createElement("h1",{className:"form__title"},"\u041e\u0442\u043f\u0440\u0430\u0432\u043b\u044f\u043b\u043a\u0430 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0439"),r.a.createElement("div",null,r.a.createElement("label",{className:"form__label"},"\u041e\u0442 \u043a\u043e\u0433\u043e"),r.a.createElement("div",{className:"form-row"},r.a.createElement(K,Object.assign({onChange:n},a.fromName)),r.a.createElement(K,Object.assign({onChange:n},a.fromEmail)))),r.a.createElement("div",null,r.a.createElement("label",{className:"form__label"},"\u041a\u043e\u043c\u0443"),r.a.createElement("div",{className:"form-row"},r.a.createElement(K,Object.assign({onChange:n},a.toName)),r.a.createElement(K,Object.assign({onChange:n},a.toEmail)))),r.a.createElement("div",null,r.a.createElement("label",{className:"form__label"},"\u0422\u0435\u043c\u0430 \u043f\u0438\u0441\u044c\u043c\u0430"),r.a.createElement("div",{className:"form-row"},r.a.createElement(K,Object.assign({onChange:n},a.subject)))),r.a.createElement("div",null,r.a.createElement("label",{className:"form__label"},"\u0421\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435"),r.a.createElement("div",{className:"form-row"},r.a.createElement(V,Object.assign({onChange:n},a.messages)))),r.a.createElement("div",null,r.a.createElement(ae,{changeHandler:s,attaches:a.attaches,removeFileHandler:c})),r.a.createElement(te,{disabled:t},"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c"),i.isMessageLoading?r.a.createElement(ne,null,r.a.createElement("h2",{className:"modal__title"},"\u0421\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435 \u043f\u043e\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u043e \u0432 \u043e\u0447\u0435\u0440\u0435\u0434\u044c \u043d\u0430 \u043e\u0442\u043f\u0440\u0430\u0432\u043a\u0443"),r.a.createElement("p",null,"\u0421\u043e\u0432\u0441\u0435\u043c \u0441\u043a\u043e\u0440\u043e \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435 \u0432\u044b\u043b\u0435\u0442\u0438\u0442 \u0438\u0437 \u0441\u0435\u0440\u0432\u0435\u0440\u0430, \u0438 \u0431\u0443\u0434\u0435\u0442 \u0434\u0432\u0438\u0433\u0430\u0442\u044c\u0441\u044f \u0432 \u0441\u0442\u043e\u0440\u043e\u043d\u0443 \u043f\u043e\u0447\u0442\u044b \u043f\u043e\u043b\u0443\u0447\u0430\u0442\u0435\u043b\u044f \xab",i.currentMessage.toEmail.value,"\xbb \u0441\u043e \u0441\u043a\u043e\u0440\u043e\u0441\u0442\u044c\u044e \u044d\u043b\u0435\u043a\u0442\u0440\u043e\u043d\u043e\u0432.")):null)}),se=t(32),ce=(t(52),function(e){var a=e.children,t=e.dropFilesHandler,n=Object(se.a)({onDrop:function(e){return t(e)},noClick:!0,accept:"image/*, .doc, .xls, .pdf, .zip"}),s=n.getRootProps,c=n.isDragActive;return r.a.createElement("div",Object.assign({className:"drop-zone"},s()),a,c?r.a.createElement("div",{className:"drop-zone__modal"},r.a.createElement("div",{className:"drop-zone__modal__inner"},r.a.createElement("h2",{className:"drop-zone__title"},"\u0411\u0440\u043e\u0441\u0430\u0439\u0442\u0435 \u0444\u0430\u0439\u043b\u044b \u0441\u044e\u0434\u0430, \u044f \u043b\u043e\u0432\u043b\u044e"),r.a.createElement("p",{className:"drop-zone__p"},"\u041c\u044b \u043f\u0440\u0438\u043d\u0438\u043c\u0430\u0435\u043c \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0438 (jpg, png, gif), \u043e\u0444\u0438\u0441\u043d\u044b\u0435 \u0444\u0430\u0439\u043b\u044b (doc, xls, pdf) \u0438 zip-\u0430\u0440\u0445\u0438\u0432\u044b. \u0420\u0430\u0437\u043c\u0435\u0440\u044b \u0444\u0430\u0439\u043b\u0430 \u0434\u043e 5 \u041c\u0411"))):null)}),le=function(e){return new Promise((function(a,t){var n=new FileReader;n.readAsDataURL(e),n.onload=function(){return a(n.result)},n.onerror=function(e){return t(e)}}))};var ie={subject:{name:"subject",type:"text",placeholder:"\u0422\u0435\u043c\u0430 \u043f\u0438\u0441\u044c\u043c\u0430",value:"",error:null},fromName:{className:"left-radius",name:"fromName",type:"text",placeholder:"\u0418\u043c\u044f",value:"",error:null},fromEmail:{className:"right-radius",name:"fromEmail",type:"email",placeholder:"Email",value:"",error:null},toName:{className:"left-radius",name:"toName",type:"text",placeholder:"\u0418\u043c\u044f",value:"",error:null},toEmail:{className:"right-radius",name:"toEmail",type:"email",placeholder:"Email",value:"",error:null},messages:{type:"text",name:"messages",placeholder:"\u0422\u0435\u043a\u0441\u0442 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f",value:"",error:null},attaches:[]},oe=Object(l.b)((function(e){return{isMessageLoading:e.messages.loading,currentMessage:e.messages.currentMessage}}),{requestMessages:function(e){return{type:d,payload:{message:e,loading:!0}}}})((function(e){var a=Object(G.a)({},e),t=Object(n.useState)(ie),s=Object(P.a)(t,2),c=s[0],l=s[1],i=Object(n.useState)(!1),o=Object(P.a)(i,2),d=o[0],f=o[1],g=Object(n.useState)(!1),p=Object(P.a)(g,2),v=p[0],E=p[1],b=function(e){var a=e.filter((function(e){return e.size/1024/1024<5}));if([].concat(Object(u.a)(c.attaches),Object(u.a)(a)).reduce((function(e,a){return e+a.size}),0)/1024/1024<20){var t=a.map((function(e){return function(e){var a;return _.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,_.a.awrap(le(e));case 2:return a=t.sent,t.abrupt("return",{name:e.name,content:a,encoding:"base64",size:e.size});case 4:case"end":return t.stop()}}))}(e)}));Promise.all(t).then((function(e){l(Object(m.a)({},c,{attaches:[].concat(Object(u.a)(c.attaches),Object(u.a)(e))}))}))}},h=function(e){a.requestMessages(e),l(ie)},O=function(){var e=!0;for(var a in c){var t=q(c[a].value,c[a].type);t&&(c[a].error=t,e=!1)}return l(Object(m.a)({},c)),e};return Object(n.useEffect)((function(){for(var e in c)if(c[e].error)return f(!0);d&&f(!1)}),[c,d]),Object(n.useEffect)((function(){a.isMessageLoading?E(!0):setTimeout((function(){return E(!1)}),4e3)}),[a.isMessageLoading]),r.a.createElement(ce,{dropFilesHandler:b},r.a.createElement(re,{isMessageLoading:v,currentMessage:a.currentMessage,fields:c,formError:d,submitHandler:function(e){e.preventDefault(),O()?h(c):f(!1)},handlerInputChange:function(e){var a=e.name,t=e.value,n=e.error;l(Object(m.a)({},c,Object(J.a)({},a,Object(m.a)({},c[a],{value:t,error:n}))))},handlerAttachesChange:b,handlerRemoveFile:function(e){c.attaches.splice(e,1),l(Object(m.a)({},c,{attaches:Object(u.a)(c.attaches)}))}}))})),ue=(t(53),function(e){var a=e.messages,t=[r.a.createElement("div",{className:"text-green"},"\u041e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u043e"),r.a.createElement("div",{className:"text-gray"},"\u0412 \u043e\u0447\u0435\u0440\u0435\u0434\u0438"),r.a.createElement("div",{className:"text-red"},"\u041e\u0448\u0438\u0431\u043a\u0430")],n=Object(u.a)(a).reverse();return r.a.createElement("div",{className:"flex-table-wrap"},r.a.createElement("h2",{className:"flex-table__title"},"\u041e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u043d\u044b\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f"),a.length?r.a.createElement("div",null,r.a.createElement("div",{className:"flex-table-header"},r.a.createElement("div",{className:"flex-table-row"},r.a.createElement("div",null,"\u0414\u0430\u0442\u0430"),r.a.createElement("div",null,"\u0422\u0435\u043c\u0430"),r.a.createElement("div",null,"\u0421\u0442\u0430\u0442\u0443\u0441"))),r.a.createElement("div",{className:"flex-table-body"},n.map((function(e){var a=e.date,n=e.title,s=e.status,c=e.trackId;return r.a.createElement("div",{className:"flex-table-row",key:c},r.a.createElement("div",null,a),r.a.createElement("div",null,n),-1===s?t[0]:s>-1?t[1]:t[2])})))):r.a.createElement("p",null,"\u0421\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f \u0435\u0449\u0451 \u043d\u0435 \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u044f\u043b\u0438\u0441\u044c"))});var me=Object(l.b)((function(e){return{messages:e.messages.data}}),{updateMessageTrack:function(e){return{type:p,payload:{messages:e}}}})((function(e){var a=e.messages,t=e.updateMessageTrack;return Object(n.useEffect)((function(){t(a)}),[]),r.a.createElement(ue,{messages:a})}));t(54);var de=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(oe,null),r.a.createElement(me,null))},fe=Object(o.a)(),ge=(window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||i.d)(Object(i.a)(fe)),pe=Object(i.e)(j,{},ge);fe.run(L),c.a.render(r.a.createElement(l.a,{store:pe},r.a.createElement(de,null)),document.getElementById("root"))}},[[34,1,2]]]);
//# sourceMappingURL=main.9c03a067.chunk.js.map